<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui">
    <title>快速入门</title>
    <link type="text/css" rel="stylesheet" href="../assets/css/github-markdown.css">
    <link type="text/css" rel="stylesheet" href="../assets/css/pilcrow.css">
    <link type="text/css" rel="stylesheet" href="../assets/css/hljs-github.min.css"/>
  </head>
  <body>
    <article class="markdown-body"><h2 id="-"><a class="header-link" href="#-"></a>快速入门</h2>
<p>解压 <code>hustngx.tar.gz</code>，进入 <code>hustngx</code> 目录，编写 <code>hello.json</code> 文件，内容如下：</p>
<pre class="hljs"><code>{
    "<span class="hljs-attribute">module</span>": <span class="hljs-value"><span class="hljs-string">"hustmqha"</span></span>,
    "<span class="hljs-attribute">handlers</span>":
    <span class="hljs-value">[
        {
            "<span class="hljs-attribute">uri</span>": <span class="hljs-value"><span class="hljs-string">"test"</span>
        </span>}
    ]
</span>}</code></pre><p>运行如下命令：</p>
<pre class="hljs"><code><span class="hljs-tag">python</span> <span class="hljs-tag">hustngx</span><span class="hljs-class">.py</span> <span class="hljs-tag">nginx-1</span><span class="hljs-class">.9</span><span class="hljs-class">.4</span><span class="hljs-class">.tar</span><span class="hljs-class">.gz</span> <span class="hljs-tag">hello</span><span class="hljs-class">.json</span></code></pre><p>此时可以看到生成了 <code>hustmqha</code> 目录，进入该目录，可以看到如下文件（目录）：</p>
<pre class="hljs"><code><span class="hljs-tag">nginx</span>            # <span class="hljs-tag">nginx</span>代码主目录
<span class="hljs-tag">deploygen</span><span class="hljs-class">.py</span>     # 一键部署脚本生成器
<span class="hljs-tag">deploy_ngx</span><span class="hljs-class">.json</span>  # <span class="hljs-tag">deploygen</span><span class="hljs-class">.py</span> 的命令配置文件
<span class="hljs-tag">hosts</span>            # <span class="hljs-tag">deploygen</span><span class="hljs-class">.py</span> 的机器列表配置文件
<span class="hljs-tag">deploy</span><span class="hljs-class">.sh</span>        # 一键部署脚本 (<span class="hljs-tag">deploygen</span><span class="hljs-class">.py</span>+<span class="hljs-tag">deploy_ngx</span><span class="hljs-class">.json</span>+<span class="hljs-tag">hosts</span> 生成)
<span class="hljs-tag">upgrade</span><span class="hljs-class">.sh</span>       # <span class="hljs-tag">nginx</span> 平滑升级脚本</code></pre><p>进入 <code>nginx/conf</code> 目录，编辑 <code>sample.json</code> 如下：</p>
<pre class="hljs"><code>{
    "<span class="hljs-attribute">module</span>": <span class="hljs-value"><span class="hljs-string">"hustmqha"</span></span>,
    "<span class="hljs-attribute">worker_connections</span>": <span class="hljs-value"><span class="hljs-number">1048576</span></span>,
    "<span class="hljs-attribute">listen</span>": <span class="hljs-value"><span class="hljs-number">8080</span></span>,
    "<span class="hljs-attribute">local_cmds</span>": <span class="hljs-value">[<span class="hljs-string">"/test"</span>]
</span>}</code></pre><p>生成 nginx 配置文件：</p>
<pre class="hljs"><code><span class="hljs-tag">python</span> <span class="hljs-tag">genconf</span><span class="hljs-class">.py</span> <span class="hljs-tag">sample</span><span class="hljs-class">.json</span></code></pre><p>编译安装nginx:</p>
<pre class="hljs"><code><span class="hljs-keyword">cd</span> hustmqha/nginx/
<span class="hljs-keyword">sh</span> Config.<span class="hljs-keyword">sh</span> &amp;&amp; <span class="hljs-keyword">make</span> install</code></pre><p>安装完成之后，启动 nginx：</p>
<pre class="hljs"><code><span class="hljs-title">cd</span> /<span class="hljs-typedef"><span class="hljs-keyword">data</span>/hustmqha/sbin</span>
./nginx</code></pre><p>输入如下测试命令：</p>
<pre class="hljs"><code>curl -<span class="hljs-tag">i</span> -X GET <span class="hljs-string">'localhost:8080/test'</span></code></pre><p>可以看到服务器返回如下内容：</p>
<pre class="hljs"><code><span class="hljs-status">HTTP/1.1 <span class="hljs-number">200</span> OK</span>
<span class="hljs-attribute">Server</span>: <span class="hljs-string">nginx/1.9.4</span>
<span class="hljs-attribute">Date</span>: <span class="hljs-string">Tue, 03 Nov 2015 03:54:37 GMT</span>
<span class="hljs-attribute">Content-Type</span>: <span class="hljs-string">text/plain</span>
<span class="hljs-attribute">Content-Length</span>: <span class="hljs-string">12</span>
<span class="hljs-attribute">Connection</span>: <span class="hljs-string">keep-alive</span>

<span class="erlang-repl"><span class="hljs-variable">Hello</span> <span class="hljs-variable">World</span><span class="hljs-exclamation_mark">!</span></span></code></pre><p>返回该结果说明服务器工作正常。</p>
<p><a href="../index.html">根目录</a></p>
    </article>
  </body>
</html>
